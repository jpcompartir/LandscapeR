---
title: "changelog"
author: "Jack Penzer"
date: '2022-12-05'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Timeline & Changes:

Friday 2nd December -
Tidyevaluate changes, now plotly's NSE is taken care of in a 'just in time'-esque way and original variables are left untouched

Monday 5th Dec
`.labs_render()` function trialling
Editing the sentiment_distribution plot

moving sentiment function from HelpR to LandscapeR
refactored a lot of code to be more trim/concise
fixed reactive_labels (using input[[]] syntax - helpful pattern)


Tuesday 6th December
First job = refactor the .titles_render function in zzz



```{r}
library(JPackage)
library(tidyverse)
library(lubridate)
library(ParseR)
library(SegmentR)
library(HelpR)
library(LimpiaR)
library(tm)
library(tidytext)

df <- read_csv("~/Downloads/conversation_landscape_df.csv")

df <- df %>%
mutate(date = as.Date(date)) %>%
clean_text(clean_text) %>%
mutate(clean_text = tm::removeWords(clean_text, tm::stopwords(kind = "smart")))
names(df)

df %>%
  LandscapeR::conversation_landscape(permalink, id = document, text_var = text, colour_var = cluster, cleaned_text_var = clean_text, date_var = date, sentiment_var = sentiment)
```


```{r}
titles_render <- function(plot_type, input){

  plot_type_title <- stringr::str_to_title(plot_type)

  shiny::renderUI({
    if(eval(parse(text = paste0("input$toggle", plot_type_title, "titles"))) == "TRUE"){
      shiny::tagList(
        shiny::textInput(inputId = paste0(plot_type, "Title"), label = "Title",
                         placeholder = "Write title here...", value = ""),
        shiny::textInput(inputId = paste0(plot_type, "Subtitle"), label = "Subtitle",
                         placeholder = "Write subtitle here...", value = ""),
        shiny::textInput(inputId = paste0(plot_type, "Caption"), label = "Caption",
                         placeholder = "Write caption here...", value = ""),
        shiny::textInput(inputId = paste0(plot_type, "Xlabel"), label = "X axis title",
                         placeholder = "Write the x axis title here..."),
        shiny::textInput(inputId = paste0(plot_type, "Ylabel"), label = "Y axis title",
                         placeholder = "Write the y axis title here")
      )
    }
  })
}
```

